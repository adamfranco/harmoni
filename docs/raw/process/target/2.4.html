<html>
	<head>
		<title>Authentication & DBC</title>
		<link rel="stylesheet" type="text/css" href="common.css">
	</head>
	
	<body>
		<!-- top nav bar -->
		<div class="navbar">
			<table border="0" cellpadding="0" width="100%">
				<tr>
					<td align="left" width="30%">
						<a href='2.html#QuickServicesIntroduction'>prev</a> (Quick Services Introduction)					</td>
					<td align="center" width="30%">
						<a href='2.html'>up</a> (Getting Started) | 						<a href="index.html">Home</a>
					</td>
					<td align="right" width="30%">
						<a href='3.html'>next</a> (The Services Setup)					</td>
				</tr>
			</table>
		</div>
		<!-- end -->

		<table width="100%" cellpadding="0" cellspacing="0">
	<tr>
		<td>&nbsp;</td>
		<td width="50%" align="center">
			<div class="title">
				:: Table of Contents ::
			</div>
			<div class='toc0'>
2.4 <a href='2.4.html'>Authentication & DBC</a><br/>
<div class='toc'>
2.4.1 <a href='2.4.html#IntroductiontoAuthentication'>Introduction to Authentication</a><br/>
</div>
<div class='toc'>
2.4.2 <a href='2.4.html#SimpleDatabaseAuthentication'>Simple Database Authentication</a><br/>
</div>
<div class='toc'>
2.4.3 <a href='2.4.html#SimpleDatabaseAccess'>Simple Database Access</a><br/>
</div>
</div>
		</td>
		<td>&nbsp;</td>
	</tr>
</table><div class='title'>Subchapter 2.4: Authentication & DBC</div>
<div class='content'>
<div class='inlinetitle'>2.4.1 <a name='IntroductiontoAuthentication'>Introduction to Authentication</a></div>
<div class='section'>
<p><p>Although it's a nice gesture to open your programs to all internet users, sometimes it isn't exactly what you, or your users, are looking for. Authentication is in essence the process of finding out that the person sitting behind the computer terminal is indeed, who they claim to be. The most common form of internet authentication is <i>username/password</i> pair authentication. For this guide, we will use this type. Other types include: SSL-certificate, SSH keys, retinal scanning (not so common on the internet), and so on.</p></p>
<p><p>Once you've chosen an authentication type (<i>username/password</i>), there are multiple ways in which your program can come across this information. One common method is to store the username and an ecrypted version of the password in an SQL database, or in a file on the filesystem. For our example, we are going to store this information in a database. Further, one program might access multiple authentication methods for any given type; you may get &quot;authoritative&quot; users from one local database, faculty/staff from a central institution database, remote users from another institution's database, etc. For most users, limiting authentication to one source is enough. For larger enterprise-level applications, authenticating on multiple sources can be very useful; program logic may change depending on where the end user is, or what institution they are from. It could be as simple as changing the banner logo to one they can relate to (but come on people, use your imagination!). </p></p>
</div>
<div class='inlinetitle'>2.4.2 <a name='SimpleDatabaseAuthentication'>Simple Database Authentication</a></div>
<div class='section'>
<p><p>Harmoni has a service registered under the name &quot;Authentication&quot;. This service is an instatiation of the <i>AuthenticationHandler</i> class. See the PHPDoc for details. The AuthenticationHandler is essentially an organizer of <i>AuthenticationMethod</i>s. A single <i>AuthenticationMethod</i> can access a database, an LDAP server, a flat file, an IMAP server, etc. The Handler can keep track of as many of these as you'd like. For this example, we will add only one Method to the Handler. The following code sets up the AuthenticationHandler to check a user's username and password against two fields in a database.</p></p>
<div class='padding'><div class='notetitle'>Example</div><div class='example'><code><font color="#000000">
<font color="#0000BB">require_once</font><font color="#007700">(</font><font color="#DD0000">"/path/to/harmoni.inc.php"</font><font color="#007700">);<br /><br /></font><font color="#FF8000">// :: get all the services we need ::<br /></font><font color="#0000BB">$authHandler </font><font color="#007700">=&amp; </font><font color="#0000BB">Services</font><font color="#007700">::</font><font color="#0000BB">getService</font><font color="#007700">(</font><font color="#DD0000">"Authentication"</font><font color="#007700">);<br /></font><font color="#0000BB">$dbHandler </font><font color="#007700">=&amp; </font><font color="#0000BB">Services</font><font color="#007700">::</font><font color="#0000BB">getService</font><font color="#007700">(</font><font color="#DD0000">"DBHandler"</font><font color="#007700">);<br /><br /></font><font color="#FF8000">// :: set up the database connection ::<br /></font><font color="#0000BB">$dbIndex </font><font color="#007700">= </font><font color="#0000BB">$dbHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">addDatabase</font><font color="#007700">( <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new </font><font color="#0000BB">MySQLDatabase</font><font color="#007700">(&nbsp;&nbsp;</font><font color="#DD0000">"my.host.com"</font><font color="#007700">, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"myAppDB"</font><font color="#007700">, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"username"</font><font color="#007700">, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"password"</font><font color="#007700">) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br /><br /></font><font color="#FF8000">// :: set up the DBAuthenticationMethod options ::<br /></font><font color="#0000BB">$options </font><font color="#007700">=&amp; new </font><font color="#0000BB">DBMethodOptions</font><font color="#007700">;<br /></font><font color="#0000BB">$options</font><font color="#007700">-&gt;</font><font color="#0000BB">set</font><font color="#007700">(</font><font color="#DD0000">"databaseIndex"</font><font color="#007700">,</font><font color="#0000BB">$dbIndex</font><font color="#007700">);<br /></font><font color="#0000BB">$options</font><font color="#007700">-&gt;</font><font color="#0000BB">set</font><font color="#007700">(</font><font color="#DD0000">"tableName"</font><font color="#007700">, </font><font color="#DD0000">"users"</font><font color="#007700">);<br /></font><font color="#0000BB">$options</font><font color="#007700">-&gt;</font><font color="#0000BB">set</font><font color="#007700">(</font><font color="#DD0000">"usernameField"</font><font color="#007700">, </font><font color="#DD0000">"users_username"</font><font color="#007700">);<br /></font><font color="#0000BB">$options</font><font color="#007700">-&gt;</font><font color="#0000BB">set</font><font color="#007700">(</font><font color="#DD0000">"passwordField"</font><font color="#007700">, </font><font color="#DD0000">"users_password"</font><font color="#007700">);<br /><br /></font><font color="#FF8000">// :: the following options are not required, but suggested ::<br /></font><font color="#0000BB">$options</font><font color="#007700">-&gt;</font><font color="#0000BB">set</font><font color="#007700">(</font><font color="#DD0000">"passwordFieldEncrypted"</font><font color="#007700">, </font><font color="#0000BB">true</font><font color="#007700">); </font><font color="#FF8000">// default = false<br /></font><font color="#0000BB">$options</font><font color="#007700">-&gt;</font><font color="#0000BB">set</font><font color="#007700">(</font><font color="#DD0000">"passwordFieldEncryptionType"</font><font color="#007700">, </font><font color="#DD0000">"databaseMD5"</font><font color="#007700">); </font><font color="#FF8000">// options: databaseMD5, databaseSHA1, crypt<br /><br />// :: create the DBAuthenticationMethod with the above options ::<br /></font><font color="#0000BB">$dbAuthMethod </font><font color="#007700">=&amp; new </font><font color="#0000BB">DBAuthenticationMethod</font><font color="#007700">(</font><font color="#0000BB">$options</font><font color="#007700">);<br /><br /></font><font color="#FF8000">// :: add it to the handler ::<br /></font><font color="#0000BB">$authHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">addMethod</font><font color="#007700">(</font><font color="#DD0000">"someName"</font><font color="#007700">,</font><font color="#0000BB">0</font><font color="#007700">,</font><font color="#0000BB">$dbAuthMethod</font><font color="#007700">);</font>
</font>
</code></div></div>
<p><p>Somewhere later in your code, you could include something like:</p></p>
<div class='padding'><div class='notetitle'>Example</div><div class='example'><code><font color="#000000">
<font color="#0000BB">$someUser </font><font color="#007700">= </font><font color="#DD0000">"gabeschine"</font><font color="#007700">;<br /></font><font color="#0000BB">$somePass </font><font color="#007700">= </font><font color="#DD0000">"secret"</font><font color="#007700">;<br /><br /></font><font color="#0000BB">$result </font><font color="#007700">=&amp; </font><font color="#0000BB">$authHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">authenticateAllMethods</font><font color="#007700">(</font><font color="#0000BB">$someUser</font><font color="#007700">, </font><font color="#0000BB">$somePass</font><font color="#007700">);<br /><br />if (</font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">isValid</font><font color="#007700">()) {<br />&nbsp;&nbsp;&nbsp;&nbsp;print </font><font color="#DD0000">"Hey, "</font><font color="#007700">.</font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">getSystemName</font><font color="#007700">().</font><font color="#DD0000">", looks like you're in!&lt;br /&gt;"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;print </font><font color="#DD0000">"You authenticated in "</font><font color="#007700">.</font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">getValidMethodCount</font><font color="#007700">().</font><font color="#DD0000">" methods, named: " </font><font color="#007700">. <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">implode</font><font color="#007700">(</font><font color="#DD0000">", "</font><font color="#007700">, </font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">getValidMethods</font><font color="#007700">()) .<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"&lt;br /&gt;"</font><font color="#007700">;<br />} else {<br />&nbsp;&nbsp;&nbsp;&nbsp;print </font><font color="#DD0000">"Sorry, "</font><font color="#007700">.</font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">getSystemName</font><font color="#007700">().</font><font color="#DD0000">". No go my friend.&lt;br /&gt;"</font><font color="#007700">;<br />}</font>
</font>
</code></div></div>
<p><p>The above code contacts the database &quot;my.host.com&quot;, looks for the &quot;myAppDB&quot; database, and checks, within the table &quot;users&quot;, for the two fields &quot;users_username&quot; and &quot;users_password&quot;. The <i>DBAuthenticationMethod</i> assumes that the database holds passwords that were encrypted using its own MD5() function. Assuming that $someUser and $somePass were given by an end user, you smart people can figure out how this is useful.</p></p>
<div class='padding'><div class='notetitle'>NOTE</div><div class='note'><note>In order to avoid users entering their password every page load, you need to authenticate them and then store their credentials in some secure fashion. Unfortunately, this opens up your system to unwanted users. For this purpose, the Harmoni framework offers the LoginHandler. It will both store user credentials through a session, but also (optionally) use a database for secure hash generation, which makes it close to impossible for a hacker to fake a valid login.</note></div></div>
</div>
<div class='inlinetitle'>2.4.3 <a name='SimpleDatabaseAccess'>Simple Database Access</a></div>
<div class='section'>
<p><p>The Harmoni database wrapper, handled by the <i>DBHandler</i> class, provides access to SQL databases. Supported databases include: MySQL, PostgreSQL, Oracle, Microsoft SQL Server, and through OKI's SQL OSID, which, as of the time of this writing, is not yet complete.</p></p>
<p><p>You might wonder (if you've looked at some code or the PHPDoc) why using such a seemingly round-about approach to database access is useful. For those of you that aim to connect to only one specific type of database, these wrappers may not be so useful. However, in order to target the largest audience in the internet community, it is important to keep in mind that people are different; specifically, some use MySQL, some PostgreSQL, and so on. The Harmoni <i>DBHandler</i> allows you to use <b>identical</b> PHP code to <i>select</i>, <i>insert</i>, <i>update</i> and <i>delete</i> rows from databases, even if they are of different kinds. This way, no matter if the person that downloads your program uses Oracle or MySQL, your code WILL WORK.</p></p>
<p><p>So, without further ado, let's look at some simple database access scripts.</p></p>
<div class='heading'>:: Connecting/Disconnecting ::</div>
<div class='padding'><div class='notetitle'>Example</div><div class='example'><code><font color="#000000">
<font color="#0000BB">$dbHandler </font><font color="#007700">=&amp; </font><font color="#0000BB">Services</font><font color="#007700">::</font><font color="#0000BB">getService</font><font color="#007700">(</font><font color="#DD0000">"DBHandler"</font><font color="#007700">);<br /><br /></font><font color="#0000BB">$dbIndex </font><font color="#007700">= </font><font color="#0000BB">$dbHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">addDatabase</font><font color="#007700">(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new </font><font color="#0000BB">PostgreSQLDatabase</font><font color="#007700">(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"my.host.com"</font><font color="#007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"myDatabaseName"</font><font color="#007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"myUser"</font><font color="#007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"secret"</font><font color="#007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></font><font color="#0000BB">$dbHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">connect</font><font color="#007700">(</font><font color="#0000BB">$dbIndex</font><font color="#007700">);<br /></font><font color="#FF8000">// you could also use $dbHandler-&gt;pConnect($dbIndex);<br />// for a persistent connection.<br /><br /></font><font color="#007700">if (</font><font color="#0000BB">$dbHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">isConnected</font><font color="#007700">(</font><font color="#0000BB">$dbIndex</font><font color="#007700">)) print </font><font color="#DD0000">"We're connected!"</font><font color="#007700">;<br />else print </font><font color="#DD0000">"Doh."</font><font color="#007700">;<br /><br /></font><font color="#0000BB">$dbHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">disconnect</font><font color="#007700">(</font><font color="#0000BB">$dbIndex</font><font color="#007700">);</font>
</font>
</code></div></div>
<p><p>The above code does nothing more than connect to a Postgres database and then disconnect. Amazing.</p></p>
<div class='heading'>:: Select Query ::</div>
<p><p>Now, let's fetch some data from a table named &quot;table1&quot;.</p></p>
<div class='padding'><div class='notetitle'>Example</div><div class='example'><code><font color="#000000">
<font color="#0000BB">$query </font><font color="#007700">=&amp; new </font><font color="#0000BB">SelectQuery</font><font color="#007700">;<br /><br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setTable</font><font color="#007700">(</font><font color="#DD0000">"table1"</font><font color="#007700">);<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">addColumn</font><font color="#007700">(</font><font color="#DD0000">"column1"</font><font color="#007700">);<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">addColumn</font><font color="#007700">(</font><font color="#DD0000">"column2"</font><font color="#007700">, </font><font color="#DD0000">"anAlias"</font><font color="#007700">); </font><font color="#FF8000">// fetch column2 AS anAlias<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setWhere</font><font color="#007700">(</font><font color="#DD0000">"column1 = 'jones'"</font><font color="#007700">);<br /><br /></font><font color="#FF8000">// execute the query!<br /></font><font color="#0000BB">$result </font><font color="#007700">=&amp; </font><font color="#0000BB">$dbHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">query</font><font color="#007700">(</font><font color="#0000BB">$query</font><font color="#007700">, </font><font color="#0000BB">$dbIndex</font><font color="#007700">);<br /><br />print </font><font color="#DD0000">"Our query has "</font><font color="#007700">. </font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">getNumberOfRows</font><font color="#007700">() . </font><font color="#DD0000">"rows!\n"</font><font color="#007700">;<br /><br />while (</font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">hasMoreRows</font><font color="#007700">()) {<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$array </font><font color="#007700">= </font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">getCurrentRow</font><font color="#007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;print </font><font color="#DD0000">"Result row: column1 = " </font><font color="#007700">. </font><font color="#0000BB">$array</font><font color="#007700">[</font><font color="#DD0000">'column1'</font><font color="#007700">] . </font><font color="#DD0000">", column2 AS anAlias: " </font><font color="#007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$array</font><font color="#007700">[</font><font color="#DD0000">'anAlias'</font><font color="#007700">] . </font><font color="#DD0000">"\n"</font><font color="#007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">advanceRow</font><font color="#007700">();<br />}</font>
</font>
</code></div></div>
<p><p>The above might output something like:</p></p>
<div class='block'><code>Our&nbsp;query&nbsp;has&nbsp;3&nbsp;rows!<br />Result&nbsp;row:&nbsp;column1&nbsp;=&nbsp;jones,&nbsp;column2&nbsp;AS&nbsp;anAlias&nbsp;=&nbsp;fred<br />Result&nbsp;row:&nbsp;column1&nbsp;=&nbsp;jones,&nbsp;column2&nbsp;AS&nbsp;anAlias&nbsp;=&nbsp;george<br />Result&nbsp;row:&nbsp;column1&nbsp;=&nbsp;jones,&nbsp;column2&nbsp;AS&nbsp;anAlias&nbsp;=&nbsp;franky</code></div>
<p><p>The SQL query could look something like:</p></p>
<div class='block'><code>SELECT&nbsp;column1,&nbsp;column2&nbsp;AS&nbsp;anAlias<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;table1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;column1&nbsp;=&nbsp;'jones'</code></div>
<p><p>This is a very simple example. The SelectQuery can do a whole lot more. Take a look at the PHPDoc or later chapters for more information.</p></p>
<div class='heading'>:: Insert Query ::</div>
<div class='padding'><div class='notetitle'>Example</div><div class='example'><code><font color="#000000">
<font color="#0000BB">$query </font><font color="#007700">=&amp; new </font><font color="#0000BB">InsertQuery</font><font color="#007700">;<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setTable</font><font color="#007700">(</font><font color="#DD0000">"table1"</font><font color="#007700">);<br /><br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setColumns</font><font color="#007700">(<br />&nbsp;&nbsp;&nbsp;&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"column1"</font><font color="#007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"column2"</font><font color="#007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;);<br /><br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">addRowOfValues</font><font color="#007700">(<br />&nbsp;&nbsp;&nbsp;&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"jones"</font><font color="#007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"margy"</font><font color="#007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;);<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">addRowOfValues</font><font color="#007700">(<br />&nbsp;&nbsp;&nbsp;&nbsp;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"jameson"</font><font color="#007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#DD0000">"bobby"</font><font color="#007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;);<br /><br /></font><font color="#0000BB">$result </font><font color="#007700">=&amp; </font><font color="#0000BB">$dbHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">query</font><font color="#007700">(</font><font color="#0000BB">$query</font><font color="#007700">, </font><font color="#0000BB">$dbIndex</font><font color="#007700">);<br /><br />if (</font><font color="#0000BB">$result</font><font color="#007700">) {<br />&nbsp;&nbsp;&nbsp;&nbsp;print </font><font color="#DD0000">"Success! We inserted " </font><font color="#007700">. </font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">getNumberOfRows</font><font color="#007700">() . </font><font color="#DD0000">" rows into the database!\n"</font><font color="#007700">;<br />} else {<br />&nbsp;&nbsp;&nbsp;&nbsp;print </font><font color="#DD0000">"Ergh. Something happened.\n"</font><font color="#007700">;<br />}</font>
</font>
</code></div></div>
<p><p>Under MySQL, the query would look like:</p></p>
<div class='block'><code>INSERT<br />&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;table1<br />&nbsp;&nbsp;&nbsp;&nbsp;(column1,&nbsp;column2)<br />&nbsp;&nbsp;&nbsp;&nbsp;VALUES&nbsp;("jones",&nbsp;"margy")<br />&nbsp;&nbsp;&nbsp;&nbsp;VALUES&nbsp;("jameson",&nbsp;"bobby")</code></div>
<div class='heading'>:: Update Query ::</div>
<div class='padding'><div class='notetitle'>Example</div><div class='example'><code><font color="#000000">
<font color="#0000BB">$query </font><font color="#007700">=&amp; new </font><font color="#0000BB">UpdateQuery</font><font color="#007700">;<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setTable</font><font color="#007700">(</font><font color="#DD0000">"table1"</font><font color="#007700">);<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setColumns</font><font color="#007700">(array(</font><font color="#DD0000">"column1"</font><font color="#007700">));<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setValues</font><font color="#007700">(array(</font><font color="#DD0000">"yodle"</font><font color="#007700">));<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setWhere</font><font color="#007700">(</font><font color="#DD0000">"column1='jones'"</font><font color="#007700">);<br /><br /></font><font color="#0000BB">$result </font><font color="#007700">=&amp; </font><font color="#0000BB">$dbHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">query</font><font color="#007700">(</font><font color="#0000BB">$query</font><font color="#007700">,</font><font color="#0000BB">$dbIndex</font><font color="#007700">);<br /><br />print </font><font color="#DD0000">"There were " </font><font color="#007700">. </font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">getNumberOfRows</font><font color="#007700">() . </font><font color="#DD0000">" members of the jones family."</font><font color="#007700">;</font>
</font>
</code></div></div>
<p><p>The &quot;jones&quot; family just changed their last name to &quot;yodle&quot;. Don't ask me. Here's the query under MySQL:</p></p>
<div class='block'><code>UPDATE<br />&nbsp;&nbsp;&nbsp;&nbsp;table1<br />&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;column1&nbsp;=&nbsp;"yodle"<br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;column1&nbsp;=&nbsp;"jones"</code></div>
<div class='heading'>:: Delete Query ::</div>
<div class='padding'><div class='notetitle'>Example</div><div class='example'><code><font color="#000000">
<font color="#0000BB">$query </font><font color="#007700">=&amp; new </font><font color="#0000BB">DeleteQuery</font><font color="#007700">;<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setTable</font><font color="#007700">(</font><font color="#DD0000">"table1"</font><font color="#007700">);<br /></font><font color="#0000BB">$query</font><font color="#007700">-&gt;</font><font color="#0000BB">setWhere</font><font color="#007700">(</font><font color="#DD0000">"column1='yodle'"</font><font color="#007700">);<br /><br /></font><font color="#0000BB">$result </font><font color="#007700">=&amp; </font><font color="#0000BB">$dbHandler</font><font color="#007700">-&gt;</font><font color="#0000BB">query</font><font color="#007700">(</font><font color="#0000BB">$query</font><font color="#007700">,</font><font color="#0000BB">$dbIndex</font><font color="#007700">);<br /><br />print </font><font color="#DD0000">"The yodle family just lost " </font><font color="#007700">. </font><font color="#0000BB">$result</font><font color="#007700">-&gt;</font><font color="#0000BB">getNumberOfRows</font><font color="#007700">() . </font><font color="#DD0000">" members."</font><font color="#007700">;</font>
</font>
</code></div></div>
<p><p>Bad new... the &quot;yodle&quot; family just choked. Away they go. Here's the SQL:</p></p>
<div class='block'><code>DELETE<br />&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;table1<br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;column1&nbsp;=&nbsp;"yodle"</code></div>
<p><p>So, now you know how to do the basics and essentials to use databases. And no more writing SQL for you SQL-phobic folks out there!</p></p>
</div>
</div>		
		<!-- bottom nav bar -->
		<div class="navbar">
			<table border="0" cellpadding="0" width="100%">
				<tr>
					<td align="left" width="30%">
						<a href='2.html#QuickServicesIntroduction'>prev</a> (Quick Services Introduction)					</td>
					<td align="center" width="30%">
						<a href='2.html'>up</a> (Getting Started) | 						<a href="index.html">Home</a>
					</td>
					<td align="right" width="30%">
						<a href='3.html'>next</a> (The Services Setup)					</td>
				</tr>
			</table>
		</div>
		<!-- end -->
	</body>
</html>